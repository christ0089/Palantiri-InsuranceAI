version: "2.0"
rules:
- rule: Say 'I am a bot' anytime the user challenges
  steps:
  - intent: bot_challenge
  - action: utter_iamabot
- rule: Say costs any time the user says costs
  steps:
  - intent: cost
  - action: utter_costs
- rule: Repeat las intent answer 
  condition:
  - active_loop: policy_sale
  steps:
  - intent: repeat_question
  - action: utter_repeat
- rule: Say how the policy works
  steps:
  - intent: how_it_works
  - action: utter_how_it_works

#
# Form Handler 
#


- rule: Start Policy
  condition:
  - slot_was_set:
    - name
  steps:
  - or:
    - intent: confirm
    - intent: deny
  - action: policy_sale
  - active_loop: policy_sale


- rule: utterResponse
  condition:
  - active_loop: policy_sale
  - slot_was_set:
    - requested_slot: A_has_insurance
  steps:
  - intent: confirm
  - action: utter_ask_A_has_insurance
  
- rule: Submit form deny
  condition:
  - active_loop: policy_sale
  - slot_was_set:
    - D_reasoning_for_rejection
  steps:
  - intent: deny
  - action: utter_goodbye
  - action: policy_sale
  - active_loop: null
  - slot_was_set:
    - requested_slot: null


- rule: Submit form
  condition:
  - active_loop: policy_sale
  steps:
  - action: policy_sale
  - active_loop: null
  - slot_was_set:
    - requested_slot: null
  - action: utter_submit
